<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistiques Loto FDJ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1>ğŸ“Š Statistiques Loto FDJ</h1>
        <p>Analyse complÃ¨te de <span id="totalDraws">-</span> tirages â€” Du <span id="dateRange">-</span></p>
        <p style="font-size:0.75rem; color:var(--muted)">DonnÃ©es officielles FDJ â€¢ Depuis le changement de rÃ¨gles de nov. 2019 (5 boules parmi 49 + 1 NÂ° Chance parmi 10)</p>
        <p id="updateStatus" style="font-size:0.75rem; color:var(--chance); margin-top:0.3rem;">Chargement...</p>
    </header>

    <div class="container">
        <!-- Last Draw -->
        <div class="last-draw" id="lastDrawSection" style="display:none">
            <h2>ğŸ± Dernier tirage</h2>
            <div class="draw-date" id="lastDrawDate">-</div>
            <div class="draw-balls" id="lastDrawBalls"></div>
        </div>

        <!-- Summary Stats -->
        <div class="stats-summary">
            <div class="stat-card">
                <div class="value" id="statTotal">-</div>
                <div class="label">Tirages analysÃ©s</div>
            </div>
            <div class="stat-card">
                <div class="value" id="statMostCommon">-</div>
                <div class="label">Boule la + frÃ©quente</div>
            </div>
            <div class="stat-card">
                <div class="value" id="statLeastCommon">-</div>
                <div class="label">Boule la - frÃ©quente</div>
            </div>
            <div class="stat-card">
                <div class="value" id="statMaxRetard">-</div>
                <div class="label">Plus grand retard actuel</div>
            </div>
            <div class="stat-card">
                <div class="value" id="statChance">-</div>
                <div class="label">NÂ° Chance le + frÃ©quent</div>
            </div>
        </div>

        <!-- Tabs -->
        <nav class="tabs" id="mainTabs">
            <button class="active" data-tab="freq">FrÃ©quences</button>
            <button data-tab="retard">Retards</button>
            <button data-tab="chance">NÂ° Chance</button>
            <button data-tab="pairs">Paires & Triplets</button>
            <button data-tab="heatmap">Heatmap Paires</button>
            <button data-tab="evolution">Ã‰volution</button>
            <button data-tab="repartition">RÃ©partition</button>
            <button data-tab="suggestions">Suggestions</button>
            <button data-tab="retroanalyse">RÃ©troanalyse</button>
            <button data-tab="analyzer">Analyseur</button>
        </nav>

        <!-- TAB: FrÃ©quences -->
        <div class="tab-content active" id="tab-freq">
            <div class="filter-bar">
                <label>PÃ©riode :</label>
                <select id="filterPeriod">
                    <option value="all">Tous les tirages</option>
                    <option value="365">12 derniers mois</option>
                    <option value="180">6 derniers mois</option>
                    <option value="90">3 derniers mois</option>
                    <option value="50">50 derniers tirages</option>
                    <option value="100">100 derniers tirages</option>
                </select>
                <label>Tri :</label>
                <select id="filterSort">
                    <option value="num">Par numÃ©ro</option>
                    <option value="asc">Moins frÃ©quent â†’ Plus frÃ©quent</option>
                    <option value="desc">Plus frÃ©quent â†’ Moins frÃ©quent</option>
                </select>
            </div>
            <div class="chart-container">
                <h3>FrÃ©quence de sortie de chaque boule (1 Ã  49)</h3>
                <canvas id="chartFreq"></canvas>
            </div>
            <div class="chart-container">
                <h3>Boules classÃ©es de la moins Ã  la plus tirÃ©e</h3>
                <div id="numberGrid" class="number-grid"></div>
                <div style="margin-top:1rem">
                    <span class="legend-item"><span class="legend-dot" style="background:#ef4444"></span> TrÃ¨s rare</span>
                    <span class="legend-item"><span class="legend-dot" style="background:#f97316"></span> Rare</span>
                    <span class="legend-item"><span class="legend-dot" style="background:#eab308"></span> Normal</span>
                    <span class="legend-item"><span class="legend-dot" style="background:#22c55e"></span> FrÃ©quent</span>
                    <span class="legend-item"><span class="legend-dot" style="background:#3b82f6"></span> TrÃ¨s frÃ©quent</span>
                </div>
            </div>
        </div>

        <!-- TAB: Retards -->
        <div class="tab-content" id="tab-retard">
            <div class="chart-container">
                <h3>ğŸ”´ Retard actuel â€” Nombre de tirages depuis la derniÃ¨re sortie</h3>
                <p class="info-text">Plus le retard est grand, plus le numÃ©ro n'est pas sorti depuis longtemps.</p>
                <canvas id="chartRetard"></canvas>
            </div>
            <div class="grid-2">
                <div class="chart-container">
                    <h3>Top 15 â€” Plus grands retards actuels</h3>
                    <canvas id="chartTopRetard"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Retard maximum historique par boule</h3>
                    <canvas id="chartMaxRetard"></canvas>
                </div>
            </div>
        </div>

        <!-- TAB: Chance -->
        <div class="tab-content" id="tab-chance">
            <div class="grid-2">
                <div class="chart-container">
                    <h3>FrÃ©quence des numÃ©ros Chance (1-10)</h3>
                    <canvas id="chartChance"></canvas>
                </div>
                <div class="chart-container">
                    <h3>RÃ©partition NÂ° Chance (camembert)</h3>
                    <canvas id="chartChancePie"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h3>Retard actuel des numÃ©ros Chance</h3>
                <canvas id="chartChanceRetard"></canvas>
            </div>
        </div>

        <!-- TAB: Paires & Triplets -->
        <div class="tab-content" id="tab-pairs">
            <div class="grid-2">
                <div class="chart-container">
                    <h3>ğŸ”» 15 Paires les MOINS frÃ©quentes (intÃ©ressant Ã  jouer ensemble)</h3>
                    <canvas id="chartLeastPairs"></canvas>
                </div>
                <div class="chart-container">
                    <h3>15 Paires les plus frÃ©quentes</h3>
                    <canvas id="chartTopPairs"></canvas>
                </div>
            </div>
            <div class="grid-2">
                <div class="chart-container">
                    <h3>ğŸ”» 15 Triplets les MOINS frÃ©quents</h3>
                    <canvas id="chartLeastTriplets"></canvas>
                </div>
                <div class="chart-container">
                    <h3>15 Triplets les plus frÃ©quents</h3>
                    <canvas id="chartTopTriplets"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h3>ğŸ° Regroupements par dizaine â€” 3 numÃ©ros ou plus dans la mÃªme dizaine</h3>
                <p class="info-text">Analyse la frÃ©quence des tirages oÃ¹ 3 numÃ©ros ou plus tombent dans la mÃªme tranche de 10 (1-10, 11-20, 21-30, 31-40, 41-49).</p>
                <div class="grid-2" style="margin-top:1rem">
                    <canvas id="chartDecadeClusters"></canvas>
                    <canvas id="chartDecadeDetail"></canvas>
                </div>
                <div id="decadeClusterInfo" style="margin-top:1rem"></div>
            </div>
        </div>

        <!-- TAB: Heatmap -->
        <div class="tab-content" id="tab-heatmap">
            <div class="chart-container">
                <h3>Heatmap des paires â€” Combien de fois chaque paire est sortie ensemble</h3>
                <p class="info-text">Croisez ligne et colonne pour voir le nombre de fois que deux boules sont sorties ensemble. Les cases les plus foncÃ©es indiquent les paires les plus rares.</p>
                <div class="heatmap-container" id="heatmapDiv"></div>
            </div>
        </div>

        <!-- TAB: Ã‰volution -->
        <div class="tab-content" id="tab-evolution">
            <div class="filter-bar">
                <label>NumÃ©ro Ã  suivre :</label>
                <select id="evoNumber"></select>
            </div>
            <div class="chart-container">
                <h3>Ã‰volution de la frÃ©quence cumulÃ©e</h3>
                <canvas id="chartEvolution"></canvas>
            </div>
            <div class="chart-container">
                <h3>Ã‰cart entre les sorties (nombre de tirages entre chaque apparition)</h3>
                <canvas id="chartGaps"></canvas>
            </div>
        </div>

        <!-- TAB: RÃ©partition -->
        <div class="tab-content" id="tab-repartition">
            <div class="grid-2">
                <div class="chart-container">
                    <h3>RÃ©partition par dizaine</h3>
                    <canvas id="chartDecades"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Pair vs Impair dans les tirages</h3>
                    <canvas id="chartParite"></canvas>
                </div>
            </div>
            <div class="grid-2">
                <div class="chart-container">
                    <h3>Somme des 5 boules â€” Distribution</h3>
                    <canvas id="chartSomme"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Ã‰cart (max - min) des 5 boules â€” Distribution</h3>
                    <canvas id="chartEcart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h3>FrÃ©quence par jour de tirage</h3>
                <canvas id="chartJours"></canvas>
            </div>
        </div>

        <!-- TAB: Suggestions -->
        <div class="tab-content" id="tab-suggestions">
            <div class="chart-container">
                <h3>ğŸ’¡ NumÃ©ros "froids" â€” Les moins sortis rÃ©cemment</h3>
                <p class="info-text">BasÃ© sur les numÃ©ros avec le plus grand retard ET la plus faible frÃ©quence. Ce n'est pas une prÃ©diction â€” le Loto reste un jeu de hasard pur.</p>
                <div class="suggestion-box" id="coldSuggestion"></div>
            </div>
            <div class="chart-container">
                <h3>ğŸ§Š NumÃ©ros "glacÃ©s" â€” Statistiquement sous-reprÃ©sentÃ©s</h3>
                <p class="info-text">NumÃ©ros qui sont sortis significativement moins que la moyenne attendue.</p>
                <div class="suggestion-box" id="frozenSuggestion"></div>
            </div>
            <div class="chart-container">
                <h3>ğŸ¯ Combinaison basÃ©e sur les retards + faible frÃ©quence</h3>
                <p class="info-text">Une grille composÃ©e des 5 numÃ©ros les plus en retard et du NÂ° Chance le plus en retard.</p>
                <div class="suggestion-box" id="comboSuggestion"></div>
            </div>
            <div class="chart-container">
                <h3>ğŸ² Grilles "Mix Ã©quilibrÃ©" â€” 1 froid + 1 chaud + 3 moyens (3 tranches)</h3>
                <p class="info-text">5 combinaisons composÃ©es d'un numÃ©ro parmi les moins sortis (â„ï¸ froid), d'un parmi les plus sortis (ğŸ”¥ chaud), et de 3 numÃ©ros pris dans 3 tranches de frÃ©quence : basse-moyenne, moyenne, haute-moyenne.</p>
                <div class="suggestion-box" id="mixSuggestion"></div>
            </div>
            <div class="chart-container">
                <h3>ğŸ“Š Analyse Ã©cart Ã  la moyenne</h3>
                <canvas id="chartDeviation"></canvas>
            </div>
        </div>

        <!-- TAB: RÃ©troanalyse -->
        <div class="tab-content" id="tab-retroanalyse">
            <div class="chart-container">
                <h3>ğŸ”¬ RÃ©troanalyse des suggestions â€” Validation historique</h3>
                <p class="info-text">Pour chaque tirage (Ã  partir du 30áµ‰), on recalcule ce qu'auraient Ã©tÃ© les suggestions en utilisant <strong>uniquement les tirages passÃ©s</strong>, puis on compare au rÃ©sultat rÃ©el. Cela permet de mesurer la fiabilitÃ© de chaque stratÃ©gie.</p>
                <p class="info-text">RÃ©fÃ©rence hasard pur : en moyenne <strong>0.51 boules</strong> sur 5 correspondent par pur hasard (5Ã—5/49), et <strong>10%</strong> de chance pour le NÂ° Chance (1/10).</p>
                <div id="retroLoading" style="text-align:center;padding:2rem;color:var(--muted)">â³ Calcul en cours... Analyse de ~960 tirages</div>
                <div id="retroResults" style="display:none">
                    <div class="stats-summary" id="retroSummary"></div>
                </div>
            </div>
            <div id="retroChartsContainer" style="display:none">
                <div class="grid-2">
                    <div class="chart-container">
                        <h3>ğŸ“Š Moyenne de boules correctes par stratÃ©gie</h3>
                        <p class="info-text">Nombre moyen de boules correctement prÃ©dites sur 5, comparÃ© au hasard (ligne rouge).</p>
                        <canvas id="chartRetroAvg"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>ğŸ¯ Taux de match du NÂ° Chance</h3>
                        <p class="info-text">Pourcentage de fois oÃ¹ le NÂ° Chance suggÃ©rÃ© correspondait au tirage rÃ©el (hasard = 10%).</p>
                        <canvas id="chartRetroChance"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>ğŸ“ˆ Distribution des correspondances (0 Ã  5 boules justes)</h3>
                    <p class="info-text">Pour chaque stratÃ©gie, combien de fois la suggestion a eu 0, 1, 2, 3, 4 ou 5 boules correctes.</p>
                    <canvas id="chartRetroDistrib"></canvas>
                </div>
                <div class="chart-container">
                    <h3>ğŸ“‰ Ã‰volution des correspondances dans le temps (moyenne glissante sur 50 tirages)</h3>
                    <p class="info-text">Observe si une stratÃ©gie s'amÃ©liore ou se dÃ©grade au fil du temps.</p>
                    <canvas id="chartRetroEvo"></canvas>
                </div>
                <div class="chart-container">
                    <h3>ğŸ† Meilleurs rÃ©sultats â€” Tirages avec â‰¥ 2 boules correctes</h3>
                    <p class="info-text">Liste des tirages oÃ¹ au moins une stratÃ©gie a trouvÃ© 2 boules ou plus.</p>
                    <div id="retroBestTable"></div>
                </div>
            </div>
        </div>
        <!-- TAB: Analyseur -->
        <div class="tab-content" id="tab-analyzer">
            <div class="chart-container">
                <h3>ğŸ” Analyseur de combinaison personnalisÃ©e</h3>
                <p class="info-text">Entrez vos 5 numÃ©ros (1-49) et votre NÂ° Chance (1-10), puis cliquez sur Analyser pour obtenir une analyse complÃ¨te de votre grille.</p>
                <div class="ana-input-row">
                    <div class="ana-input-group">
                        <label>Boules</label>
                        <div class="ana-balls-inputs">
                            <input type="number" id="anaBall1" min="1" max="49" placeholder="1">
                            <input type="number" id="anaBall2" min="1" max="49" placeholder="2">
                            <input type="number" id="anaBall3" min="1" max="49" placeholder="3">
                            <input type="number" id="anaBall4" min="1" max="49" placeholder="4">
                            <input type="number" id="anaBall5" min="1" max="49" placeholder="5">
                        </div>
                    </div>
                    <div class="ana-input-group">
                        <label>Chance</label>
                        <div class="ana-balls-inputs">
                            <input type="number" id="anaChance" min="1" max="10" placeholder="1" class="chance-input">
                        </div>
                    </div>
                    <button id="analyzerBtn" class="ana-btn">ğŸ” Analyser</button>
                </div>
            </div>
            <div id="analyzerResults" style="display:none"></div>
        </div>
    </div>

    <footer>
        <p>DonnÃ©es officielles FDJÂ® â€” Tirages depuis nov. 2019</p>
        <p>âš ï¸ Le Loto est un jeu de hasard. Les statistiques passÃ©es n'influencent pas les tirages futurs.</p>
    </footer>

    <script type="module" src="js/app.js"></script>
</body>
</html>
